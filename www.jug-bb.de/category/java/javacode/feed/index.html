<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:series="http://organizeseries.com/"
	>

<channel>
	<title>Java User Group Berlin Brandenburg &#187; Java Code Beispiele</title>
	<atom:link href="http://www.jug-bb.de/category/java/javacode/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.jug-bb.de</link>
	<description>Der Blog der JUG-BB</description>
	<lastBuildDate>Sun, 29 Dec 2013 15:02:50 +0000</lastBuildDate>
	<language>de-DE</language>
		<sy:updatePeriod>hourly</sy:updatePeriod>
		<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.8.2</generator>
	<item>
		<title>Quelltext zum &#8220;Scala in der Praxis&#8221;-Vortrag</title>
		<link>http://www.jug-bb.de/2011/11/quelltext-zum-scala-in-der-praxis-vortrag/</link>
		<comments>http://www.jug-bb.de/2011/11/quelltext-zum-scala-in-der-praxis-vortrag/#comments</comments>
		<pubDate>Fri, 04 Nov 2011 22:26:15 +0000</pubDate>
		<dc:creator><![CDATA[Oliver Fischer]]></dc:creator>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Java Code Beispiele]]></category>

		<guid isPermaLink="false">http://www.jug-bb.de/?p=802</guid>
		<description><![CDATA[Auf Bitte einiger Teilnehmer unseres gestrigen Vortrags mit Arno Haase zu Scala in der Praxis ist hier der Quelltext. package a &#160; &#160; sealed abstract class Expr case class IntExpr &#40;i: Int&#41; extends Expr case class VarExpr &#40;name: String&#41; extends Expr case class BinExpr &#40;left: Expr, right: Expr, op: String&#41; extends Expr &#160; object Expr [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Auf Bitte einiger Teilnehmer unseres gestrigen Vortrags mit Arno Haase zu Scala in der Praxis ist hier der Quelltext.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="scala" style="font-family:monospace;"><span style="color: #0000ff; font-weight: bold;">package</span> a
&nbsp;
&nbsp;
<span style="color: #0000ff; font-weight: bold;">sealed</span> <span style="color: #0000ff; font-weight: bold;">abstract</span> <span style="color: #0000ff; font-weight: bold;">class</span> Expr 
<span style="color: #0000ff; font-weight: bold;">case</span> <span style="color: #0000ff; font-weight: bold;">class</span> IntExpr <span style="color: #F78811;">&#40;</span>i<span style="color: #000080;">:</span> Int<span style="color: #F78811;">&#41;</span> <span style="color: #0000ff; font-weight: bold;">extends</span> Expr
<span style="color: #0000ff; font-weight: bold;">case</span> <span style="color: #0000ff; font-weight: bold;">class</span> VarExpr <span style="color: #F78811;">&#40;</span>name<span style="color: #000080;">:</span> String<span style="color: #F78811;">&#41;</span> <span style="color: #0000ff; font-weight: bold;">extends</span> Expr
<span style="color: #0000ff; font-weight: bold;">case</span> <span style="color: #0000ff; font-weight: bold;">class</span> BinExpr <span style="color: #F78811;">&#40;</span>left<span style="color: #000080;">:</span> Expr, right<span style="color: #000080;">:</span> Expr, op<span style="color: #000080;">:</span> String<span style="color: #F78811;">&#41;</span> <span style="color: #0000ff; font-weight: bold;">extends</span> Expr
&nbsp;
<span style="color: #0000ff; font-weight: bold;">object</span> Expr <span style="color: #F78811;">&#123;</span>
  <span style="color: #0000ff; font-weight: bold;">def</span> eval <span style="color: #F78811;">&#40;</span>e<span style="color: #000080;">:</span> Expr, vars<span style="color: #000080;">:</span> Map<span style="color: #F78811;">&#91;</span>String, Int<span style="color: #F78811;">&#93;</span><span style="color: #F78811;">&#41;</span><span style="color: #000080;">:</span> Int <span style="color: #000080;">=</span> e <span style="color: #0000ff; font-weight: bold;">match</span> <span style="color: #F78811;">&#123;</span>
    <span style="color: #0000ff; font-weight: bold;">case</span> IntExpr <span style="color: #F78811;">&#40;</span>i<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=&gt;</span> i
    <span style="color: #0000ff; font-weight: bold;">case</span> VarExpr <span style="color: #F78811;">&#40;</span>v<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=&gt;</span> vars<span style="color: #F78811;">&#40;</span>v<span style="color: #F78811;">&#41;</span>
    <span style="color: #0000ff; font-weight: bold;">case</span> BinExpr <span style="color: #F78811;">&#40;</span>left, right, <span style="color: #6666FF;">&quot;+&quot;</span><span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=&gt;</span> eval <span style="color: #F78811;">&#40;</span>left, vars<span style="color: #F78811;">&#41;</span> + eval <span style="color: #F78811;">&#40;</span>right, vars<span style="color: #F78811;">&#41;</span>
    <span style="color: #0000ff; font-weight: bold;">case</span> BinExpr <span style="color: #F78811;">&#40;</span>left, right, <span style="color: #6666FF;">&quot;*&quot;</span><span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=&gt;</span> eval <span style="color: #F78811;">&#40;</span>left, vars<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">*</span> eval <span style="color: #F78811;">&#40;</span>right, vars<span style="color: #F78811;">&#41;</span>
  <span style="color: #F78811;">&#125;</span>
<span style="color: #F78811;">&#125;</span>
&nbsp;
<span style="color: #0000ff; font-weight: bold;">class</span> ExprWithSyntax <span style="color: #F78811;">&#40;</span>e<span style="color: #000080;">:</span> Expr<span style="color: #F78811;">&#41;</span> <span style="color: #F78811;">&#123;</span>
  <span style="color: #0000ff; font-weight: bold;">def</span> + <span style="color: #F78811;">&#40;</span>other<span style="color: #000080;">:</span> Expr<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=</span> BinExpr <span style="color: #F78811;">&#40;</span>e, other, <span style="color: #6666FF;">&quot;+&quot;</span><span style="color: #F78811;">&#41;</span>
  <span style="color: #0000ff; font-weight: bold;">def</span> <span style="color: #000080;">*</span> <span style="color: #F78811;">&#40;</span>other<span style="color: #000080;">:</span> Expr<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=</span> BinExpr <span style="color: #F78811;">&#40;</span>e, other, <span style="color: #6666FF;">&quot;*&quot;</span><span style="color: #F78811;">&#41;</span>
&nbsp;
  <span style="color: #0000ff; font-weight: bold;">def</span> apply <span style="color: #F78811;">&#40;</span>vars<span style="color: #000080;">:</span> <span style="color: #F78811;">&#40;</span>String, Int<span style="color: #F78811;">&#41;</span><span style="color: #000080;">*</span><span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #F78811;">&#123;</span>
    <span style="color: #0000ff; font-weight: bold;">val</span> m <span style="color: #000080;">=</span> vars.<span style="color: #000000;">foldLeft</span> <span style="color: #F78811;">&#40;</span>Map<span style="color: #F78811;">&#91;</span>String, Int<span style="color: #F78811;">&#93;</span><span style="color: #F78811;">&#40;</span><span style="color: #F78811;">&#41;</span><span style="color: #F78811;">&#41;</span> <span style="color: #F78811;">&#40;</span><span style="color: #F78811;">&#40;</span>res, cur<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=&gt;</span> res + cur<span style="color: #F78811;">&#41;</span>
    Expr.<span style="color: #000000;">eval</span> <span style="color: #F78811;">&#40;</span>e, m<span style="color: #F78811;">&#41;</span>
  <span style="color: #F78811;">&#125;</span>
<span style="color: #F78811;">&#125;</span>
&nbsp;
<span style="color: #0000ff; font-weight: bold;">object</span> ExpressionSyntax <span style="color: #F78811;">&#123;</span>
  <span style="color: #0000ff; font-weight: bold;">implicit</span> <span style="color: #0000ff; font-weight: bold;">def</span> intAsExpr <span style="color: #F78811;">&#40;</span>i<span style="color: #000080;">:</span> Int<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=</span> IntExpr <span style="color: #F78811;">&#40;</span>i<span style="color: #F78811;">&#41;</span>
  <span style="color: #0000ff; font-weight: bold;">implicit</span> <span style="color: #0000ff; font-weight: bold;">def</span> withSyntax <span style="color: #F78811;">&#40;</span>e<span style="color: #000080;">:</span> Expr<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #0000ff; font-weight: bold;">new</span> ExprWithSyntax <span style="color: #F78811;">&#40;</span>e<span style="color: #F78811;">&#41;</span>
  <span style="color: #0000ff; font-weight: bold;">implicit</span> <span style="color: #0000ff; font-weight: bold;">def</span> intWithSyntax <span style="color: #F78811;">&#40;</span>i<span style="color: #000080;">:</span> Int<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #0000ff; font-weight: bold;">new</span> ExprWithSyntax <span style="color: #F78811;">&#40;</span>IntExpr <span style="color: #F78811;">&#40;</span>i<span style="color: #F78811;">&#41;</span><span style="color: #F78811;">&#41;</span>
  <span style="color: #0000ff; font-weight: bold;">def</span> Var <span style="color: #F78811;">&#40;</span>s<span style="color: #000080;">:</span> String<span style="color: #F78811;">&#41;</span> <span style="color: #000080;">=</span> VarExpr <span style="color: #F78811;">&#40;</span>s<span style="color: #F78811;">&#41;</span>
<span style="color: #F78811;">&#125;</span>
&nbsp;
<span style="color: #0000ff; font-weight: bold;">object</span> HelloMain <span style="color: #F78811;">&#123;</span>
  <span style="color: #0000ff; font-weight: bold;">def</span> main <span style="color: #F78811;">&#40;</span>args<span style="color: #000080;">:</span> Array<span style="color: #F78811;">&#91;</span>String<span style="color: #F78811;">&#93;</span><span style="color: #F78811;">&#41;</span> <span style="color: #F78811;">&#123;</span>
    <span style="color: #0000ff; font-weight: bold;">import</span> ExpressionSyntax.<span style="color: #000080;">_</span>
    <span style="color: #0000ff; font-weight: bold;">val</span> e <span style="color: #000080;">=</span> <span style="color: #F78811;">5</span> <span style="color: #000080;">*</span> <span style="color: #F78811;">&#40;</span><span style="color: #F78811;">3</span> + Var <span style="color: #F78811;">&#40;</span><span style="color: #6666FF;">&quot;x&quot;</span><span style="color: #F78811;">&#41;</span><span style="color: #F78811;">&#41;</span>
&nbsp;
<span style="color: #008000; font-style: italic;">//    println (Expr.eval (e, Map (&quot;x&quot; -&gt; 2)))</span>
    println <span style="color: #F78811;">&#40;</span>e <span style="color: #F78811;">&#40;</span><span style="color: #6666FF;">&quot;x&quot;</span> -<span style="color: #000080;">&gt;</span> <span style="color: #F78811;">2</span><span style="color: #F78811;">&#41;</span><span style="color: #F78811;">&#41;</span>
  <span style="color: #F78811;">&#125;</span>
<span style="color: #F78811;">&#125;</span></pre></td></tr></table></div>

]]></content:encoded>
			<wfw:commentRss>http://www.jug-bb.de/2011/11/quelltext-zum-scala-in-der-praxis-vortrag/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>ANT tasks der Java User Group</title>
		<link>http://www.jug-bb.de/2010/06/ant-task-der-java-user-group-bb/</link>
		<comments>http://www.jug-bb.de/2010/06/ant-task-der-java-user-group-bb/#comments</comments>
		<pubDate>Wed, 09 Jun 2010 20:20:21 +0000</pubDate>
		<dc:creator><![CDATA[Jan Lolling]]></dc:creator>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Java Code Beispiele]]></category>

		<guid isPermaLink="false">http://www.jug-bb.de/?p=515</guid>
		<description><![CDATA[Ant ist ein überaus mächtiges Werkzeug für die Automatisierung und Sicherstellung des build-Prozesses in immer gleicher Qualität. Zudem ist es sehr leicht anpassbar und erweiterbar. Hier ein paar Beispiele aus der Java User Group: Task zum Generieren von Java Code für den Zugriff auf Icons Task zum Erstellen eines Java web Start Deployment descriptors (jnlp [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Ant ist ein überaus mächtiges Werkzeug für die Automatisierung und Sicherstellung des build-Prozesses in immer gleicher Qualität. Zudem ist es sehr leicht anpassbar und erweiterbar.<br />
Hier ein paar Beispiele aus der Java User Group:</p>
<ul>
<li><a href="http://web.me.com/jan.lolling/ant/iconCodeGenTask.html" target="_new">Task zum Generieren von Java Code für den Zugriff auf Icons</a></li>
<li><a href="http://web.me.com/jan.lolling/ant/jnlpTask.html" target="_new">Task zum Erstellen eines Java web Start Deployment descriptors (jnlp file)</a></li>
<li><a href="http://web.me.com/jan.lolling/ant/propertyMergeTask.html" target="_new">Task zum Zusammenfuehren von Property files</a></li>
</ul>
<p>Diese Task sind als Binaries und Source code verfügbar und stehen unter der GPL. Da diese Libs nicht in Produkte integriert werden stellt die GPL auch kein Problem für den kommerziellen Einsatz dieser Task dar.</p>
<p>Diese Task sind bereits im produktiven Einsatz in aktuell 3 Projekten (1 Open Source Projekt und 2 Individual Projekte für kommerzielle Zwecke).</p>
<p>Viel Spass beim Ausprobieren.</p>
<p>Wir freuen uns über Anregungen und Kommetare: jan dot lolling at googlemail dot com.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.jug-bb.de/2010/06/ant-task-der-java-user-group-bb/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>JDBC Metadaten für Oracle stored procedures</title>
		<link>http://www.jug-bb.de/2010/04/jdbc-metadaten-fur-oracle-stored-procedures/</link>
		<comments>http://www.jug-bb.de/2010/04/jdbc-metadaten-fur-oracle-stored-procedures/#comments</comments>
		<pubDate>Mon, 05 Apr 2010 20:12:48 +0000</pubDate>
		<dc:creator><![CDATA[Jan Lolling]]></dc:creator>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Java Code Beispiele]]></category>
		<category><![CDATA[Oracle JDBC Meta data]]></category>

		<guid isPermaLink="false">http://www.jug-bb.de/?p=479</guid>
		<description><![CDATA[Das Konstrukt der Packages wird durch JDBC nicht wirklich gut unterstützt. JDBC geht leider auch von eindeutigen Namen für functions und procedures aus. Somit hat man ein Problem mit überladenen procedures. Diese unterscheiden sich nicht im Namen sondern in der Anzahl und Typen der Parameter. Der Oracle-JDBC-Treiber gibt alle Informationen raus, es erfordert nur etwas [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Das Konstrukt der Packages wird durch JDBC nicht wirklich gut unterstützt. JDBC geht leider auch von eindeutigen Namen für functions und procedures aus. Somit hat man ein Problem mit überladenen procedures. Diese unterscheiden sich nicht im Namen sondern in der Anzahl und Typen der Parameter.<br />
Der Oracle-JDBC-Treiber gibt alle Informationen raus, es erfordert nur etwas Geschick diese Informationen einzusammeln.<br />
1. Die Name der packages werden als CATALOG ausgegeben.<br />
2. Die Parameter kennen ihren Index. Wenn ein Parameter für scheinbar die selbe procedure erscheint mit dem gleichen Index, dann ist das ein Zeichen für eine überladene procedure.</p>
<p>Der folgende Beispielcode geht davon aus, dass die procedures und functions in speziellen Objekten gehalten werden und die Parameter besitzen auch ihre eigene Transferklasse.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;">	<span style="color: #008000; font-style: italic; font-weight: bold;">/**
	 * load procedure and functions
	 * 
	 * @param schema
	 *            object that represent a schema
	 * @return true if everything went well
	 */</span>
	<span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">boolean</span> loadProcedures<span style="color: #009900;">&#40;</span>SQLSchema schema<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
		<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>logger.<span style="color: #006633;">isDebugEnabled</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
			logger.<span style="color: #006633;">debug</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;loadProcedures schema=&quot;</span> <span style="color: #339933;">+</span> schema<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span>
		<span style="color: #666666; font-style: italic;">// makes this thread save</span>
		inRefreshCycle <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">true</span><span style="color: #339933;">;</span>
		<span style="color: #000066; font-weight: bold;">boolean</span> ok <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">false</span><span style="color: #339933;">;</span>
		<span style="color: #666666; font-style: italic;">// don' worry about that, we use our own database pool</span>
		<span style="color: #000000; font-weight: bold;">final</span> DatabaseSession session <span style="color: #339933;">=</span> DatabaseSessionPool.<span style="color: #006633;">getDatabaseSession</span><span style="color: #009900;">&#40;</span>cd.<span style="color: #006633;">getUniqueId</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>session <span style="color: #339933;">==</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
			<span style="color: #666666; font-style: italic;">// return if no connection to database avialable</span>
			<span style="color: #000000; font-weight: bold;">return</span> <span style="color: #000066; font-weight: bold;">false</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span>
		<span style="color: #000000; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
			<span style="color: #003399;">Connection</span> conn <span style="color: #339933;">=</span> session.<span style="color: #006633;">getConnection</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			<span style="color: #003399;">DatabaseMetaData</span> dbmd <span style="color: #339933;">=</span> conn.<span style="color: #006633;">getMetaData</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			schema.<span style="color: #006633;">clearProcedures</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// remove any previously loaded procedures</span>
			<span style="color: #003399;">ResultSet</span> rs <span style="color: #339933;">=</span> dbmd.<span style="color: #006633;">getProcedures</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">null</span>, schema.<span style="color: #006633;">getName</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>, <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>rs <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
				<span style="color: #666666; font-style: italic;">// loading all procedures and functions</span>
				<span style="color: #000000; font-weight: bold;">while</span> <span style="color: #009900;">&#40;</span>rs.<span style="color: #006633;">next</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
					<span style="color: #666666; font-style: italic;">// PROCEDURE_CAT contains the package name</span>
					<span style="color: #003399;">String</span> catalogName <span style="color: #339933;">=</span> rs.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;PROCEDURE_CAT&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #003399;">String</span> name <span style="color: #339933;">=</span> rs.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;PROCEDURE_NAME&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>catalogName <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span> <span style="color: #339933;">&amp;</span>amp<span style="color: #339933;">;&amp;</span>amp<span style="color: #339933;">;</span> catalogName.<span style="color: #006633;">length</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&amp;</span>gt<span style="color: #339933;">;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
						name <span style="color: #339933;">=</span> catalogName <span style="color: #339933;">+</span> <span style="color: #0000ff;">&quot;.&quot;</span> <span style="color: #339933;">+</span> name<span style="color: #339933;">;</span>
					<span style="color: #009900;">&#125;</span>
					<span style="color: #666666; font-style: italic;">// create an new one</span>
					SQLProcedure procedure <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> SQLProcedure<span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">this</span>, schema,	name<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #666666; font-style: italic;">// decide if it is a function</span>
					<span style="color: #000066; font-weight: bold;">short</span> pType <span style="color: #339933;">=</span> rs.<span style="color: #006633;">getShort</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;PROCEDURE_TYPE&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					procedure.<span style="color: #006633;">setFunction</span><span style="color: #009900;">&#40;</span>pType <span style="color: #339933;">==</span> <span style="color: #003399;">DatabaseMetaData</span>.<span style="color: #006633;">procedureReturnsResult</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					schema.<span style="color: #006633;">addProcedure</span><span style="color: #009900;">&#40;</span>procedure<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					objectMap.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span>name, procedure<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
				<span style="color: #009900;">&#125;</span>
				rs.<span style="color: #006633;">close</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			<span style="color: #009900;">&#125;</span>
			<span style="color: #666666; font-style: italic;">// loading procedure/function parameters</span>
			rs <span style="color: #339933;">=</span> dbmd.<span style="color: #006633;">getProcedureColumns</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">null</span>, schema.<span style="color: #006633;">getName</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>, <span style="color: #000066; font-weight: bold;">null</span>, <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>rs <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
				<span style="color: #666666; font-style: italic;">// an index for overloaded procedures</span>
				<span style="color: #000066; font-weight: bold;">int</span> procedureIndex <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>
				<span style="color: #003399;">String</span> prevProcedureName <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;noprocedurehere_xx&quot;</span><span style="color: #339933;">;</span>
				<span style="color: #000000; font-weight: bold;">while</span> <span style="color: #009900;">&#40;</span>rs.<span style="color: #006633;">next</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
					<span style="color: #666666; font-style: italic;">// PROCEDURE_CAT contains the package name</span>
					<span style="color: #003399;">String</span> catalogName <span style="color: #339933;">=</span> rs.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;PROCEDURE_CAT&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #003399;">String</span> name <span style="color: #339933;">=</span> rs.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;PROCEDURE_NAME&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>catalogName <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span> <span style="color: #339933;">&amp;</span>amp<span style="color: #339933;">;&amp;</span>amp<span style="color: #339933;">;</span> catalogName.<span style="color: #006633;">length</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">&amp;</span>gt<span style="color: #339933;">;</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
						<span style="color: #666666; font-style: italic;">// add the catalog name as package name</span>
						name <span style="color: #339933;">=</span> catalogName <span style="color: #339933;">+</span> <span style="color: #0000ff;">&quot;.&quot;</span> <span style="color: #339933;">+</span> name<span style="color: #339933;">;</span>
					<span style="color: #009900;">&#125;</span>
					<span style="color: #000066; font-weight: bold;">int</span> pos <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>
					<span style="color: #000000; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
						<span style="color: #666666; font-style: italic;">// position of this parameter in the procedure parameter</span>
						<span style="color: #666666; font-style: italic;">// list</span>
						pos <span style="color: #339933;">=</span> rs.<span style="color: #006633;">getInt</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;ORDINAL_POSITION&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">Exception</span> e<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
						<span style="color: #666666; font-style: italic;">// perhaps this column is not defined in every database</span>
						<span style="color: #666666; font-style: italic;">// type</span>
						pos <span style="color: #339933;">=</span> <span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">;</span>
					<span style="color: #009900;">&#125;</span>
					<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>prevProcedureName.<span style="color: #006633;">equals</span><span style="color: #009900;">&#40;</span>name<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
						<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>pos <span style="color: #339933;">==</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
							<span style="color: #666666; font-style: italic;">// if we get the same procedure name and a parameter</span>
							<span style="color: #666666; font-style: italic;">// with position zero increase the procedure index</span>
							<span style="color: #666666; font-style: italic;">// that means point to the next procedure with the</span>
							<span style="color: #666666; font-style: italic;">// same name</span>
							procedureIndex<span style="color: #339933;">++;</span>
						<span style="color: #009900;">&#125;</span>
					<span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
						procedureIndex <span style="color: #339933;">=</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">;</span>
					<span style="color: #009900;">&#125;</span>
					<span style="color: #003399;">String</span> columnName <span style="color: #339933;">=</span> rs.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;COLUMN_NAME&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #003399;">List</span> list <span style="color: #339933;">=</span> schema.<span style="color: #006633;">getProcedures</span><span style="color: #009900;">&#40;</span>name<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					SQLProcedure procedure <span style="color: #339933;">=</span> list.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span>procedureIndex<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
					<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>procedure <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
						procedure.<span style="color: #006633;">addParameter</span><span style="color: #009900;">&#40;</span>columnName, <span style="color: #666666; font-style: italic;">// parameter name</span>
								rs.<span style="color: #006633;">getShort</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;DATA_TYPE&quot;</span><span style="color: #009900;">&#41;</span>,  <span style="color: #666666; font-style: italic;">// parameter type as</span>
														   <span style="color: #666666; font-style: italic;">// integer defined</span>
														   <span style="color: #666666; font-style: italic;">// in class</span>
														   <span style="color: #666666; font-style: italic;">// java.sql.Type</span>
								rs.<span style="color: #006633;">getString</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;TYPE_NAME&quot;</span><span style="color: #009900;">&#41;</span>, <span style="color: #666666; font-style: italic;">// parameter type as</span>
														   <span style="color: #666666; font-style: italic;">// string</span>
								rs.<span style="color: #006633;">getInt</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;LENGTH&quot;</span><span style="color: #009900;">&#41;</span>,    <span style="color: #666666; font-style: italic;">// length of the parameter</span>
														<span style="color: #666666; font-style: italic;">// if parameter is</span>
														<span style="color: #666666; font-style: italic;">// string or number type</span>
								rs.<span style="color: #006633;">getInt</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;PRECISION&quot;</span><span style="color: #009900;">&#41;</span>, <span style="color: #666666; font-style: italic;">// precision of the</span>
														<span style="color: #666666; font-style: italic;">// parameter if the</span>
														<span style="color: #666666; font-style: italic;">// parameter is a number</span>
														<span style="color: #666666; font-style: italic;">// type</span>
								rs.<span style="color: #006633;">getShort</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;COLUMN_TYPE&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// input or output</span>
														     <span style="color: #666666; font-style: italic;">// parameter as</span>
														     <span style="color: #666666; font-style: italic;">// integer:</span>
															 <span style="color: #666666; font-style: italic;">// refer</span>
															 <span style="color: #666666; font-style: italic;">// DatabaseMetaData.procedureColumnReturn</span>
					<span style="color: #009900;">&#125;</span>
					<span style="color: #666666; font-style: italic;">// keep the name of the last procedure to detect overloaded</span>
					<span style="color: #666666; font-style: italic;">// procedures</span>
					prevProcedureName <span style="color: #339933;">=</span> name<span style="color: #339933;">;</span>
				<span style="color: #009900;">&#125;</span>
				rs.<span style="color: #006633;">close</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			<span style="color: #009900;">&#125;</span>
			schema.<span style="color: #006633;">setProcedureLoaded</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			ok <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">true</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">SQLException</span> sqle<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
			<span style="color: #666666; font-style: italic;">// creates a error message to show it in GUI</span>
			errorMessage <span style="color: #339933;">=</span> <span style="color: #0000ff;">&quot;loadProcedures schema=&quot;</span> <span style="color: #339933;">+</span> schema <span style="color: #339933;">+</span> <span style="color: #0000ff;">&quot; failed: &quot;</span>
					<span style="color: #339933;">+</span> sqle.<span style="color: #006633;">getMessage</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">finally</span> <span style="color: #009900;">&#123;</span>
			<span style="color: #666666; font-style: italic;">// put the session back in the pool</span>
			DatabaseSessionPool.<span style="color: #006633;">release</span><span style="color: #009900;">&#40;</span>session<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span>
		inRefreshCycle <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">false</span><span style="color: #339933;">;</span>
		<span style="color: #000000; font-weight: bold;">return</span> ok<span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span></pre></td></tr></table></div>

]]></content:encoded>
			<wfw:commentRss>http://www.jug-bb.de/2010/04/jdbc-metadaten-fur-oracle-stored-procedures/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Java Anwendungen verpackt als deb-package</title>
		<link>http://www.jug-bb.de/2009/05/java-anwendungen-verpackt-als-deb-package/</link>
		<comments>http://www.jug-bb.de/2009/05/java-anwendungen-verpackt-als-deb-package/#comments</comments>
		<pubDate>Wed, 20 May 2009 23:30:40 +0000</pubDate>
		<dc:creator><![CDATA[Jan Lolling]]></dc:creator>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Java Code Beispiele]]></category>

		<guid isPermaLink="false">http://www.jug-bb.de/?p=382</guid>
		<description><![CDATA[Debian packages sind so ziemlich das eleganteste was es an Verteilungsmechanismen für Software gibt. Diese Art der Softwareverteilung steht auch für Java-Anwendungen zur Verfügung. Idealerweise macht man das innerhalb des build-Prozesses z.B. in Ant. Hier wird nun kurz ein sehr hilfreicher Ant-Task vorgestellt. Für eine Desktop-Anwendung unter Linux werden zum einen die eigentlichen Programm-Dateien benötigt [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Debian packages sind so ziemlich das eleganteste was es an Verteilungsmechanismen für Software gibt. Diese Art der Softwareverteilung steht auch für Java-Anwendungen zur Verfügung. Idealerweise macht man das innerhalb des build-Prozesses z.B. in Ant.<br />
Hier wird nun kurz ein sehr hilfreicher Ant-Task vorgestellt.<br />
Für eine Desktop-Anwendung unter Linux werden zum einen die eigentlichen Programm-Dateien benötigt als auch eine Datei (.desktop) die das Programm in den Menüs von KDE oder Gnome bekannt macht und zudem den Komfort bietet das Programm auch gleich für die Behandlung von Mimetypes zu registrieren. Es ist also kein Fummeln an irgendeiner Registry erforderlich, diese Zuordnung steht in der desktop-Datei und Gnome/KDE erkennen das automatisch.<br />
Hier der Link zu dem Ant-Task <a href="http://code.google.com/p/ant-deb-task/" target="new">bei Google-Code</a><br />
Es sind genau genommen 2 Ant-Tasks erforderlich:</p>
<ul>
<li>desktopentry erstellt die .desktop-Datei</li>
<li>deb erstellt das Debian-Archiv</li>
</ul>
<p>Beide sind im Projekt sehr gut dokumentiert.<br />
Hier ein Beispiel-Ant-task:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family:monospace;">    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;target</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;deb&quot;</span> <span style="color: #000066;">depends</span>=<span style="color: #ff0000;">&quot;jar&quot;</span> <span style="color: #000066;">description</span>=<span style="color: #ff0000;">&quot;build the i386 deb file&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;delete</span> <span style="color: #000066;">failonerror</span>=<span style="color: #ff0000;">&quot;false&quot;</span> <span style="color: #000000; font-weight: bold;">&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;fileset</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${distrib}&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;sqlrunner*.deb&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;sqlrunner*.desktop&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/fileset<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/delete<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;taskdef</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;desktopentry&quot;</span> <span style="color: #000066;">classname</span>=<span style="color: #ff0000;">&quot;com.googlecode.ant_deb_task.DesktopEntry&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;desktopentry</span></span>
<span style="color: #009900;">            <span style="color: #000066;">toFile</span>=<span style="color: #ff0000;">&quot;${distrib}/sqlrunner.desktop&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;SQLRunner&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">comment</span>=<span style="color: #ff0000;">&quot;Database SQL Client&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">icon</span>=<span style="color: #ff0000;">&quot;/usr/local/sqlrunner/sqlrunner.png&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">exec</span>=<span style="color: #ff0000;">&quot;/usr/local/sqlrunner/sqlrunner.sh %f&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">type</span>=<span style="color: #ff0000;">&quot;Application&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">terminal</span>=<span style="color: #ff0000;">&quot;false&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">mimeType</span>=<span style="color: #ff0000;">&quot;text/x-sql&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">path</span>=<span style="color: #ff0000;">&quot;/usr/local/sqlrunner&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">categories</span>=<span style="color: #ff0000;">&quot;Development;&quot;</span></span>
<span style="color: #009900;">        <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;taskdef</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;deb&quot;</span> <span style="color: #000066;">classname</span>=<span style="color: #ff0000;">&quot;com.googlecode.ant_deb_task.Deb&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;deb</span></span>
<span style="color: #009900;">            <span style="color: #000066;">todir</span>=<span style="color: #ff0000;">&quot;${distrib}&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">package</span>=<span style="color: #ff0000;">&quot;sqlrunner&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">section</span>=<span style="color: #ff0000;">&quot;devel&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">architecture</span>=<span style="color: #ff0000;">&quot;all&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">depends</span>=<span style="color: #ff0000;">&quot;sun-java5-jre|sun-java6-jre&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;version</span> <span style="color: #000066;">upstream</span>=<span style="color: #ff0000;">&quot;${version}&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;maintainer</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;Jan Lolling&quot;</span> <span style="color: #000066;">email</span>=<span style="color: #ff0000;">&quot;jan.lolling@mac.com&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;description</span> <span style="color: #000066;">synopsis</span>=<span style="color: #ff0000;">&quot;Java based database client&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
SQLRunner is a Java programm to handle database with a easy to use SQL interface.
.
The SQLRunner has advanced import and export capabilities. 
.
SQLRunner ships with a large number of JDBC driver (e.g. Oracle, Postgres, DB2, MS-SQL, Informix, Derby, Sybase, MaxDB, MySQL).
.
Download at SourceForge: 
.
http://sourceforge.net/projects/jugbbsqlrunner/
.
Homepage for Java Web Start:
.
http://web.me.com/jan.lolling/SQLRunner/SQLRunner.html
&nbsp;
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/description<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;tarfileset</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${lib}&quot;</span> <span style="color: #000066;">prefix</span>=<span style="color: #ff0000;">&quot;usr/local/sqlrunner&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;hsqldb.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;ifxjdbc.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;jconn3.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;ldapjdbc.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;ojdbc14.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;sqljdbc.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;mssql2000_jdbc.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;mysql-connector-java-5.1.5-bin.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;postgresql-8.2-506.jdbc2.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;sapdbc-7_6_00_30_5567.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;looks-2.1.4.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;liquidlnf.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;log4j-1.2.15.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;servlet.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;ui.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;derby.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;db2jcc4.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;db2jcc_license_cu.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;poi-3.1-FINAL-20080629.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;jnlp.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/tarfileset<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;tarfileset</span> <span style="color: #000066;">file</span>=<span style="color: #ff0000;">&quot;${distrib}/sqlrunner2.jar&quot;</span> <span style="color: #000066;">prefix</span>=<span style="color: #ff0000;">&quot;usr/local/sqlrunner&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;tarfileset</span> <span style="color: #000066;">file</span>=<span style="color: #ff0000;">&quot;${src}/sqlrunner.png&quot;</span> <span style="color: #000066;">prefix</span>=<span style="color: #ff0000;">&quot;usr/local/sqlrunner&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;tarfileset</span> <span style="color: #000066;">file</span>=<span style="color: #ff0000;">&quot;${src}/sqlrunner.sh&quot;</span> <span style="color: #000066;">prefix</span>=<span style="color: #ff0000;">&quot;usr/local/sqlrunner&quot;</span> <span style="color: #000066;">filemode</span>=<span style="color: #ff0000;">&quot;755&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;tarfileset</span> <span style="color: #000066;">file</span>=<span style="color: #ff0000;">&quot;${distrib}/sqlrunner.desktop&quot;</span> <span style="color: #000066;">prefix</span>=<span style="color: #ff0000;">&quot;usr/share/applications&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/deb<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/target<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div>

<p><strong>Hinweise zum desktopentry-Task:</strong><br />
Da man leider nicht direkt die Extention einer Datei referenzieren kann, muss man wenn man sein Programm für einen Dateityp registrieren lassen will erst den passenden mime-type finden. Gnome war so nett in den Dateiattributen z.B. für SQL-Scripte den mime-type text/x-sql zu nennen.<br />
Das Attribute &#8220;categories&#8221; beschreibt in welchem Menü später der Eintrag auftauchen soll. Es gibt festgelegte Hauptmenüpunkte &#8211; diese werden englisch vorgegeben.</p>
<p><strong>Hinweise zum deb-Task:</strong><br />
Bei der Synopsis ist zu beachten, dass der Punkt in eigener Zeile eine Leerzeile provoziert ohne den Punkt selbst darzustellen.<br />
Besonders hervorzuheben ist das depends-Attribute. Hier kann man z.B. vorgeben welche packages zuvor installiert werden müssen (was dann auch automatisch getan wird. Im Fall von Java-Anwendungen sichern wir hier die Existenz der virtuellen Maschiene ab. Das Pipe ist als Oder-Verknüpfung zu verstehen.<br />
Ein deb-Archiv ist im Grunde sehr einfach. Es enthält die Dateien genauso wie sie auf dem Zielsystem auch vorhanden sein sollen. Die tarfilesets enthalten also hier alle notwendigen Dateien (inklusive der zuvor erstellten desktop-Datei). Die Pfadangaben sind allesamt relativ zu / (deshalb fehlt irritierenderweise das /-Symbol -> Kein Fehler !)</p>
]]></content:encoded>
			<wfw:commentRss>http://www.jug-bb.de/2009/05/java-anwendungen-verpackt-als-deb-package/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>JEditorPane mit Zeilenhervorhebung</title>
		<link>http://www.jug-bb.de/2009/02/jeditorpane-mit-zeilenhervorhebung/</link>
		<comments>http://www.jug-bb.de/2009/02/jeditorpane-mit-zeilenhervorhebung/#comments</comments>
		<pubDate>Sat, 07 Feb 2009 01:33:24 +0000</pubDate>
		<dc:creator><![CDATA[Jan Lolling]]></dc:creator>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Java Code Beispiele]]></category>
		<category><![CDATA[SQL]]></category>
		<category><![CDATA[Sun]]></category>

		<guid isPermaLink="false">http://blog.jug-bb.de/?p=220</guid>
		<description><![CDATA[Ich habe für meinen Editor eine Möglichkeit gesucht die aktuelle Zeile unter dem Cursor vollständig mit einer anderen Hintergrundfarbe hervorzuheben. Diese Möglichkeit habe ich folgendermassen realisiert: Zusammenfassung: Der JEditorPane füge ich einen speziellen CaretListener hinzu der bei Veränderungen des Cursors einen wiederum für die aktuelle Zeile einen Highlighter einrichtet. Das besondere ist der als innere [&#8230;]]]></description>
				<content:encoded><![CDATA[<p><!--:de-->Ich habe für meinen Editor eine Möglichkeit gesucht die aktuelle Zeile unter dem Cursor vollständig mit einer anderen Hintergrundfarbe hervorzuheben. Diese Möglichkeit habe ich folgendermassen realisiert:</p>
<p>Zusammenfassung:</p>
<p>Der JEditorPane füge ich einen speziellen CaretListener hinzu der bei Veränderungen des Cursors einen wiederum für die aktuelle Zeile einen Highlighter einrichtet. Das besondere ist der als innere Klasse realisierte HightlighterPainter. Dieser ist so entwickelt, dass er die ganze Zeile unabhängig von der Zeichenanzahl also auf die sichtbare Breite des Editors hervorhebt.</p>
<p>Hier nun der Quelltext des CaretListeners:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">package</span> <span style="color: #006699;">sqlrunner.text</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">java.awt.Color</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">java.awt.Graphics</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">java.awt.Rectangle</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">java.awt.Shape</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.event.CaretEvent</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.event.CaretListener</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.plaf.TextUI</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.BadLocationException</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.Element</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.Highlighter</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.JTextComponent</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.LayeredHighlighter</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.Position</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.Utilities</span><span style="color: #339933;">;</span>
<span style="color: #000000; font-weight: bold;">import</span> <span style="color: #006699;">javax.swing.text.View</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">class</span> HighlightCurrentLineCaretListener <span style="color: #000000; font-weight: bold;">implements</span> <span style="color: #003399;">CaretListener</span> <span style="color: #009900;">&#123;</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #003399;">Color</span> DEFAULT_COLOR <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> <span style="color: #003399;">Color</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">230</span>, <span style="color: #cc66cc;">230</span>, <span style="color: #cc66cc;">250</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #003399;">Highlighter.<span style="color: #006633;">HighlightPainter</span></span> painter<span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #003399;">Object</span> highlight<span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">public</span> HighlightCurrentLineCaretListener<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
        <span style="color: #000000; font-weight: bold;">this</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">public</span> HighlightCurrentLineCaretListener<span style="color: #009900;">&#40;</span><span style="color: #003399;">Color</span> highlightColor<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
        <span style="color: #003399;">Color</span> c <span style="color: #339933;">=</span> highlightColor <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span> <span style="color: #339933;">?</span> highlightColor <span style="color: #339933;">:</span> DEFAULT_COLOR<span style="color: #339933;">;</span>
        <span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">painter</span> <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> LineHighlightPainter<span style="color: #009900;">&#40;</span>c<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> caretUpdate<span style="color: #009900;">&#40;</span><span style="color: #003399;">CaretEvent</span> evt<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
        <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #003399;">JTextComponent</span> comp <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">JTextComponent</span><span style="color: #009900;">&#41;</span> evt.<span style="color: #006633;">getSource</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>comp <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span> <span style="color: #339933;">&amp;</span>amp<span style="color: #339933;">;&amp;</span>amp<span style="color: #339933;">;</span> <span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">highlight</span> <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
            comp.<span style="color: #006633;">getHighlighter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">removeHighlight</span><span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">highlight</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
            <span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">highlight</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
        <span style="color: #000066; font-weight: bold;">int</span> pos <span style="color: #339933;">=</span> comp.<span style="color: #006633;">getCaretPosition</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #003399;">Element</span> elem <span style="color: #339933;">=</span> <span style="color: #003399;">Utilities</span>.<span style="color: #006633;">getParagraphElement</span><span style="color: #009900;">&#40;</span>comp, pos<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">int</span> start <span style="color: #339933;">=</span> elem.<span style="color: #006633;">getStartOffset</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">int</span> end <span style="color: #339933;">=</span> elem.<span style="color: #006633;">getEndOffset</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #000000; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
            <span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">highlight</span> <span style="color: #339933;">=</span> comp.<span style="color: #006633;">getHighlighter</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">addHighlight</span><span style="color: #009900;">&#40;</span>start,
                                                                end,
                                                                <span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">painter</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
            comp.<span style="color: #006633;">repaint</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">BadLocationException</span> ex<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
            ex.<span style="color: #006633;">printStackTrace</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#125;</span>
&nbsp;
    <span style="color: #008000; font-style: italic; font-weight: bold;">/**
     * Simple highlight painter that fills a highlighted area with
     * a solid color.
     */</span>
    <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000000; font-weight: bold;">class</span> LineHighlightPainter <span style="color: #000000; font-weight: bold;">extends</span>
        <span style="color: #003399;">LayeredHighlighter.<span style="color: #006633;">LayerPainter</span></span> <span style="color: #009900;">&#123;</span>
&nbsp;
        <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #003399;">Color</span> color<span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #008000; font-style: italic; font-weight: bold;">/**
         * Constructs a new highlight painter. If &lt;code&gt;c&lt;/code&gt; is null,
         * the JTextComponent will be queried for its selection color.
         *
         * @param c
         *            the color for the highlight
         */</span>
        <span style="color: #000000; font-weight: bold;">public</span> LineHighlightPainter<span style="color: #009900;">&#40;</span><span style="color: #003399;">Color</span> c<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
            <span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">color</span> <span style="color: #339933;">=</span> c<span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
&nbsp;
        <span style="color: #008000; font-style: italic; font-weight: bold;">/**
         * Returns the color of the highlight.
         *
         * @return the color
         */</span>
        <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #003399;">Color</span> getColor<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
            <span style="color: #000000; font-weight: bold;">return</span> <span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">color</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
&nbsp;
        <span style="color: #666666; font-style: italic;">// --- HighlightPainter methods ---------------------------------------</span>
        <span style="color: #008000; font-style: italic; font-weight: bold;">/**
         * Paints a highlight.
         *
         * @param g
         *            the graphics context
         * @param offs0
         *            the starting model offset &amp;gt;= 0
         * @param offs1
         *            the ending model offset &amp;gt;= offs1
         * @param bounds
         *            the bounding box for the highlight
         * @param c
         *            the editor
         */</span>
        <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> paint<span style="color: #009900;">&#40;</span><span style="color: #003399;">Graphics</span> g, <span style="color: #000066; font-weight: bold;">int</span> offs0, <span style="color: #000066; font-weight: bold;">int</span> offs1, <span style="color: #003399;">Shape</span> bounds,
                          <span style="color: #003399;">JTextComponent</span> c<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
            <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #003399;">Rectangle</span> alloc <span style="color: #339933;">=</span> bounds.<span style="color: #006633;">getBounds</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
            <span style="color: #000000; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
                <span style="color: #666666; font-style: italic;">// --- determine locations ---</span>
                <span style="color: #003399;">TextUI</span> mapper <span style="color: #339933;">=</span> c.<span style="color: #006633;">getUI</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #003399;">Rectangle</span> p0 <span style="color: #339933;">=</span> mapper.<span style="color: #006633;">modelToView</span><span style="color: #009900;">&#40;</span>c, offs0<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #003399;">Rectangle</span> p1 <span style="color: #339933;">=</span> mapper.<span style="color: #006633;">modelToView</span><span style="color: #009900;">&#40;</span>c, offs1<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
                <span style="color: #666666; font-style: italic;">// --- render ---</span>
                <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>getColor<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    g.<span style="color: #006633;">setColor</span><span style="color: #009900;">&#40;</span>c.<span style="color: #006633;">getSelectionColor</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
                    g.<span style="color: #006633;">setColor</span><span style="color: #009900;">&#40;</span>getColor<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #009900;">&#125;</span>
                <span style="color: #000000; font-weight: bold;">final</span> <span style="color: #003399;">Rectangle</span> r <span style="color: #339933;">=</span> p0.<span style="color: #006633;">union</span><span style="color: #009900;">&#40;</span>p1<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                g.<span style="color: #006633;">fillRect</span><span style="color: #009900;">&#40;</span>r.<span style="color: #006633;">x</span>, r.<span style="color: #006633;">y</span>, r.<span style="color: #006633;">width</span>, r.<span style="color: #006633;">height</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
            <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">BadLocationException</span> e<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                <span style="color: #666666; font-style: italic;">// can't render</span>
            <span style="color: #009900;">&#125;</span>
        <span style="color: #009900;">&#125;</span>
&nbsp;
        <span style="color: #666666; font-style: italic;">// --- LayerPainter methods ----------------------------</span>
        <span style="color: #008000; font-style: italic; font-weight: bold;">/**
         * Paints a portion of a highlight.
         *
         * @param g
         *            the graphics context
         * @param offs0
         *            the starting model offset &amp;gt;= 0
         * @param offs1
         *            the ending model offset &amp;gt;= offs1
         * @param bounds
         *            the bounding box of the view, which is not
         *            necessarily the region to paint.
         * @param c
         *            the editor
         * @param view
         *            View painting for
         * @return region drawing occured in
         */</span>
        @Override
        <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #003399;">Shape</span> paintLayer<span style="color: #009900;">&#40;</span><span style="color: #003399;">Graphics</span> g, <span style="color: #000066; font-weight: bold;">int</span> offs0, <span style="color: #000066; font-weight: bold;">int</span> offs1, <span style="color: #003399;">Shape</span> bounds,
                                <span style="color: #003399;">JTextComponent</span> c, <span style="color: #003399;">View</span> view<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
            <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>getColor<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                g.<span style="color: #006633;">setColor</span><span style="color: #009900;">&#40;</span>c.<span style="color: #006633;">getSelectionColor</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
            <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
                g.<span style="color: #006633;">setColor</span><span style="color: #009900;">&#40;</span>getColor<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
            <span style="color: #009900;">&#125;</span>
            <span style="color: #666666; font-style: italic;">// Should only render part of View.</span>
            <span style="color: #000000; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
                <span style="color: #666666; font-style: italic;">// --- determine locations ---</span>
                <span style="color: #003399;">Shape</span> shape <span style="color: #339933;">=</span> view.<span style="color: #006633;">modelToView</span><span style="color: #009900;">&#40;</span>
                                               offs0,
                                               <span style="color: #003399;">Position.<span style="color: #006633;">Bias</span></span>.<span style="color: #006633;">Forward</span>,
                                               offs1,
                                               <span style="color: #003399;">Position.<span style="color: #006633;">Bias</span></span>.<span style="color: #006633;">Backward</span>,
                                               bounds<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #003399;">Rectangle</span> r <span style="color: #339933;">=</span> shape <span style="color: #000000; font-weight: bold;">instanceof</span> <span style="color: #003399;">Rectangle</span> <span style="color: #339933;">?</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">Rectangle</span><span style="color: #009900;">&#41;</span> shape
                        <span style="color: #339933;">:</span> shape.<span style="color: #006633;">getBounds</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                g.<span style="color: #006633;">fillRect</span><span style="color: #009900;">&#40;</span>r.<span style="color: #006633;">x</span>, r.<span style="color: #006633;">y</span>, c.<span style="color: #006633;">getWidth</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>, r.<span style="color: #006633;">height</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                <span style="color: #000000; font-weight: bold;">return</span> r<span style="color: #339933;">;</span>
            <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">BadLocationException</span> e<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                <span style="color: #666666; font-style: italic;">// can't render</span>
            <span style="color: #009900;">&#125;</span>
            <span style="color: #000000; font-weight: bold;">return</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#125;</span>
<span style="color: #009900;">&#125;</span></pre></td></tr></table></div>

<p>Diesen CaretListener muss man nun mit:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;">textComp.<span style="color: #006633;">addCaretListener</span><span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> HighlightCurrentLineCaretListener<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table></div>

<p>der Textkomponente hinzufügen. Hat bei mir ausgezeichnet funktioniert. Ich habe diesen Code unter Mac OS X und Windows getestet und er läuft abwärts bis Java 5.<!--:--></p>
]]></content:encoded>
			<wfw:commentRss>http://www.jug-bb.de/2009/02/jeditorpane-mit-zeilenhervorhebung/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Fenster JDialog oder JFrame Mac like dekorieren</title>
		<link>http://www.jug-bb.de/2007/09/fenster-jdialog-oder-jframe-mac-like-dekorieren/</link>
		<comments>http://www.jug-bb.de/2007/09/fenster-jdialog-oder-jframe-mac-like-dekorieren/#comments</comments>
		<pubDate>Mon, 17 Sep 2007 21:08:50 +0000</pubDate>
		<dc:creator><![CDATA[Jan Lolling]]></dc:creator>
				<category><![CDATA[Java Code Beispiele]]></category>
		<category><![CDATA[Berlin]]></category>
		<category><![CDATA[Java]]></category>

		<guid isPermaLink="false">http://www.java-berlin.de/2007/09-17/fenster-jdialog-oder-jframe-mac-like-dekorieren/</guid>
		<description><![CDATA[Beim Mac bekommt das rote Schliessen-Icon (oder sollte ich Button sagen) des Fensters in der Mitte einen schwarzen Punkt eingesetzt wenn das Fenster zu speichernde Inhalte enthält. Das ist in Java-Programmen leicht gemacht: Punkt einschalten this.getRootPane&#40;&#41;.putClientProperty&#40;&#34;windowModified&#34;, Boolean.TRUE&#41;; // schaltet den Punkt ein Punkt ausschalten this.getRootPane&#40;&#41;.putClientProperty&#40;&#34;windowModified&#34;, Boolean.FALSE&#41;; // schaltet den Punkt wieder aus Das funktioniert mit [&#8230;]]]></description>
				<content:encoded><![CDATA[<p><!--:de-->Beim Mac bekommt das rote Schliessen-Icon (oder sollte ich Button sagen) des Fensters in der Mitte einen schwarzen Punkt eingesetzt wenn das Fenster zu speichernde Inhalte enthält. Das ist in Java-Programmen leicht gemacht:</p>
<p>Punkt einschalten</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">getRootPane</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">putClientProperty</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;windowModified&quot;</span>, <span style="color: #003399;">Boolean</span>.<span style="color: #000066; font-weight: bold;">TRUE</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// schaltet den Punkt ein</span></pre></td></tr></table></div>

<p>Punkt ausschalten</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">this</span>.<span style="color: #006633;">getRootPane</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">putClientProperty</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;windowModified&quot;</span>, <span style="color: #003399;">Boolean</span>.<span style="color: #000066; font-weight: bold;">FALSE</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// schaltet den Punkt wieder aus</span></pre></td></tr></table></div>

<p>Das funktioniert mit JFrame und JDialog.<br />
Beim Mac hat es den gewünschten Effekt und auf allen anderen Systemen ist es wirkungslos (und stört nicht).<br />
Hier ein Bild dass zeigt was hier gemeint ist:<br />
<img src="http://www.jug-bb.de/wp-content/uploads/2009/03/window-decoration.jpg" alt="window-decoration" title="window-decoration" width="133" height="47" class="aligncenter size-full wp-image-351" /><!--:--></p>
]]></content:encoded>
			<wfw:commentRss>http://www.jug-bb.de/2007/09/fenster-jdialog-oder-jframe-mac-like-dekorieren/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Java-Anwendung erstellen für Mac OS X</title>
		<link>http://www.jug-bb.de/2007/08/java-anwendung-erstellen-fur-mac-os-x/</link>
		<comments>http://www.jug-bb.de/2007/08/java-anwendung-erstellen-fur-mac-os-x/#comments</comments>
		<pubDate>Wed, 22 Aug 2007 20:05:32 +0000</pubDate>
		<dc:creator><![CDATA[Jan Lolling]]></dc:creator>
				<category><![CDATA[Java]]></category>
		<category><![CDATA[Java Code Beispiele]]></category>
		<category><![CDATA[Berlin]]></category>
		<category><![CDATA[SQL]]></category>
		<category><![CDATA[Sun]]></category>

		<guid isPermaLink="false">http://www.java-berlin.de/2007/08-22/java-anwendung-erstellen-fur-mac-os-x/</guid>
		<description><![CDATA[Wer eine Mac hat will natürlich seine Java-Anwendung auch mal echt im Dock sehen oder eine sinnvolle Dateiverknüpfung nutzen usw. Das alles ist sehr einfach machbar. Also was habe ich hier nun vor: Ich werde euch an hand einer realen Anwendung zeigen wie man die Apple-Application-Events auswertet und wie man eine echte Mac-Anwendung zusammenbaut mit [&#8230;]]]></description>
				<content:encoded><![CDATA[<p><!--:de-->Wer eine Mac hat will natürlich seine Java-Anwendung auch mal echt im Dock sehen oder eine sinnvolle Dateiverknüpfung nutzen usw.<br />
Das alles ist sehr einfach machbar.<br />
Also was habe ich hier nun vor:<br />
Ich werde euch an hand einer realen Anwendung zeigen wie man die Apple-Application-Events auswertet und wie man eine echte Mac-Anwendung zusammenbaut mit ant.<br />
Meine Anwendung ist ein SQL-Client der speziell für die Entwicklung von Java-Anwendungen in Verbindung mit SQL entwicklelt wurde und darüberhinaus sehr viel Komfort bei der Handhabung der Datenbank und deren Daten mit sich bringt. Ich habe diese SQLRunner genannt und sie ist in meiner Firma mittlerweile sehr verbreitet via Java web Start.</p>
<p>Hier soll es aber nicht um Java Web Start gehen. JWS ist wirklich gut dokumentiert, dass muss ich hier nicht nachholen.</p>
<p>1. Wie kommuniziert Mac OS X mit einer Java Anwendung:<br />
Mac OS sendet an die Anwendung Events:<br />
a) zum Öffnen einer Datei<br />
b) zum Öffnen des &#8220;Einstellungen&#8230;&#8221; Dialoges<br />
c) zum Drucken einer Datei<br />
d) zum Öffnen des About-Dialoges<br />
e) zum Schliessen der Anwendung<br />
Klingt erstmal etwas merkwürdig &#8211; jedenfalls für mich.<br />
Wenn man sich Mac OS X Anwendungen ansieht so fällt auf, dass das Menü, egal was man selbst programmiert hat um einen ganz links stehenden Menüpunkt erweitert wurde der nach der Anwendung benannt ist und typischerweise aus immer den gleichen Einträgen besteht: &#8220;About&#8221;, &#8220;Preferences&#8230;&#8221;, Services (hat keinen Bezug zur Anwendung), &#8220;Exit &#8221;</p>
<p>Apple stellt in seiner Java-Implementierung nun eine API zur Verfügung die einem diese Kommunikation bereitstellt. Die dafür notwendigen Klassen sind in:</p>
<pre>/System/Library/Frameworks/JavaVM.framework/Classes/ui.jar</pre>
<p>Man sollte aber darauf achten welche JRE-Version in der Anwendung unterstützt werden soll und sich besser die Datei aus der passenden version holen.<br />
Das folgende Codesnippet zeigt die Registrierung des notwendigen EventListeners:<br />
Ein paar Vorbemerkungen:<br />
Bei mir hat der Code zum Öffnen einer Datei anfangs nicht funktioniert. Meine Anwendung wurde zwar gestartet aber es kam kein Event zum Öffnen der Datei. Das Problem lag schlicht daran, dass die nachfolgend beschriebene Registrierung zu einem Zeitpunkt erfolgte an dem Mac OS den Event bereits vorher gesendet hat. Meine Applikation hatte schlicht zu spät zugehört. Deshalb unbedingt die Registrierung soweit wie möglich nach vorn verlegen.<br />
Dann hatte ich aber das Problem, dass es zu diesem Zeitpunkt noch kein Fenster oder Editor gab der sich für die übergebenen Inhalte interessiert hätte. Das muss man so lösen, dass man z.B. den Dateinamen erstmal merkt und beim Initialisierungsprozess des Fensters nachfragt ob solche Informationen vorliegen und die dann auch gleich berücksichtigt. Der SQLRunner z.B. initialisiert sich recht langwierig, da diverse Konfigurationen eingelesen werden müssen und dieser Vorgang wird in der boolean initalizationFinished mit true dokumentiert.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000066; font-weight: bold;">void</span> main<span style="color: #009900;">&#40;</span><span style="color: #003399;">String</span><span style="color: #009900;">&#91;</span><span style="color: #009900;">&#93;</span> args<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
    commandLineArguments <span style="color: #339933;">=</span> args<span style="color: #339933;">;</span>
    <span style="color: #003399;">System</span>.<span style="color: #006633;">getProperties</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;apple.laf.useScreenMenuBar&quot;</span>, <span style="color: #0000ff;">&quot;true&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// damit Menüs oben in der Leiste landen !</span>
    BasicConfigurator.<span style="color: #006633;">configure</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// log4j minimal konfigurieren, wird später verbessert</span>
    logger.<span style="color: #006633;">info</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;SQLRunner Application Version &quot;</span> <span style="color: #339933;">+</span> VERSION<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
     <span style="color: #666666; font-style: italic;">// unbedingt soweit zum Beginn als möglich den Listener registerieren !!</span>
    <span style="color: #003399;">String</span> osname <span style="color: #339933;">=</span> <span style="color: #003399;">System</span>.<span style="color: #006633;">getProperty</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;os.name&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #666666; font-style: italic;">// laufen wir gerade auf Mac OS X ?</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>osname <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span> <span style="color: #339933;">&amp;</span>amp<span style="color: #339933;">;&amp;</span>amp<span style="color: #339933;">;</span> osname.<span style="color: #006633;">toLowerCase</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">indexOf</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;mac&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">!=</span> <span style="color: #339933;">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
        <span style="color: #666666; font-style: italic;">// diese Methode zeitlich so nah wie möglich zum Start der Anwendung ausführen !!</span>
        setupMacOSXApplicationListener<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// registrieren des Listeners</span>
    <span style="color: #009900;">&#125;</span>
... <span style="color: #006633;">die</span> Anwendung weiter initialisieren, z.<span style="color: #006633;">B</span>. <span style="color: #006633;">Konfigdateien</span> lesen und GUI erstellen usw.
<span style="color: #009900;">&#125;</span></pre></td></tr></table></div>


<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;">    <span style="color: #000000; font-weight: bold;">private</span> <span style="color: #000000; font-weight: bold;">static</span> <span style="color: #000066; font-weight: bold;">void</span> setupMacOSXApplicationListener<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
        <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>logger.<span style="color: #006633;">isDebugEnabled</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
            logger.<span style="color: #006633;">debug</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;setupMacOSXApplicationListener()&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
        <span style="color: #000000; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
            <span style="color: #000000; font-weight: bold;">final</span> com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">Application</span> application <span style="color: #339933;">=</span> com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">Application</span>.<span style="color: #006633;">getApplication</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
            application.<span style="color: #006633;">setEnabledAboutMenu</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// damit ein &quot;Über &quot; Menü erscheint</span>
            application.<span style="color: #006633;">addPreferencesMenuItem</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// &quot;Einstellen...&quot; Dialog</span>
            application.<span style="color: #006633;">setEnabledPreferencesMenu</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// diesen Dialog auch freischalten</span>
            application.<span style="color: #006633;">addApplicationListener</span><span style="color: #009900;">&#40;</span><span style="color: #000000; font-weight: bold;">new</span> com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationListener</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                <span style="color: #666666; font-style: italic;">// jemand hat auf Über... geklickt</span>
&nbsp;
                <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> handleAbout<span style="color: #009900;">&#40;</span>com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationEvent</span> ae<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>initializationFinished<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">// nur was tun wenn Anwendung bereit ist</span>
<span style="color: #666666; font-style: italic;">// .... hier den eigenen Info-Dialog zeigen oder was auch immer !</span>
                        ae.<span style="color: #006633;">setHandled</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// habe fertig...</span>
                    <span style="color: #009900;">&#125;</span>
                <span style="color: #009900;">&#125;</span>
&nbsp;
                <span style="color: #666666; font-style: italic;">// kommt z.B. wenn eine Datei aus dem Kontextmenü heraus geöffnet wird</span>
                <span style="color: #666666; font-style: italic;">// Mac OS startet ganz normal die Anwendung und versendet diesen Event</span>
                <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> handleOpenApplication<span style="color: #009900;">&#40;</span>com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationEvent</span> ae<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>ae.<span style="color: #006633;">getFilename</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">!=</span> <span style="color: #000066; font-weight: bold;">null</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                        <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>initializationFinished<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                            <span style="color: #666666; font-style: italic;">// die Anwendung ist bereit und alles initialisiert</span>
                            <span style="color: #666666; font-style: italic;">// ... alles notwendige tun um eine Datei zu laden</span>
                        <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
                            <span style="color: #666666; font-style: italic;">// die Anwendung fährt gerade hoch</span>
                            <span style="color: #666666; font-style: italic;">// noch kein Fenster da.</span>
                            <span style="color: #666666; font-style: italic;">// ich merke mir die zu ladene Datei und muss später das laden nachholen</span>
                            fileToLoad <span style="color: #339933;">=</span> ae.<span style="color: #006633;">getFilename</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// fileToLoad ist eine static String variable</span>
                        <span style="color: #009900;">&#125;</span>
                    <span style="color: #009900;">&#125;</span>
                <span style="color: #009900;">&#125;</span>
&nbsp;
                <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> handlePreferences<span style="color: #009900;">&#40;</span>com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationEvent</span> ae<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>initalizationFinished<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                        <span style="color: #666666; font-style: italic;">// ... zeige meinen eigenen Einstellen-Dialog</span>
                        ae.<span style="color: #006633;">setHandled</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// habe fertig</span>
                    <span style="color: #009900;">&#125;</span>
                <span style="color: #009900;">&#125;</span>
&nbsp;
                <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> handlePrintFile<span style="color: #009900;">&#40;</span>com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationEvent</span> ae<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #666666; font-style: italic;">// meine Anwendung kann nicht drucken und will es auch nicht</span>
                <span style="color: #009900;">&#125;</span>
&nbsp;
                <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> handleQuit<span style="color: #009900;">&#40;</span>com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationEvent</span> ae<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #666666; font-style: italic;">// ... Die Anwendung geordnet beenden</span>
                    <span style="color: #666666; font-style: italic;">// Fragen nach ggf notwendigen Speichern, Streams schliessen usw.</span>
                    ae.<span style="color: #006633;">setHandled</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">// bin mir nicht ganz sicher ob ich hier noch hinkomme ;-)</span>
                <span style="color: #009900;">&#125;</span>
&nbsp;
                <span style="color: #666666; font-style: italic;">// meine Anwendung läuft bereits und jemand klickt unten auf mein Dock-Icon</span>
                <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> handleReOpenApplication<span style="color: #009900;">&#40;</span>com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationEvent</span> ae<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #666666; font-style: italic;">// ich würde hier ein weiteres Fenster aufmachen ...</span>
                <span style="color: #009900;">&#125;</span>
&nbsp;
                <span style="color: #666666; font-style: italic;">// kommt z.B. wenn eine Datei aus dem Kontextmenü heraus geöffnet wird</span>
                <span style="color: #666666; font-style: italic;">// Die Anwwendung ist aber schon vorher gestartet worden</span>
                <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000066; font-weight: bold;">void</span> handleOpenFile<span style="color: #009900;">&#40;</span>com.<span style="color: #006633;">apple</span>.<span style="color: #006633;">eawt</span>.<span style="color: #006633;">ApplicationEvent</span> ae<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
                    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>initializationFinished<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #666666; font-style: italic;">// sicher ist sicher</span>
                        <span style="color: #666666; font-style: italic;">// Datei öffnen</span>
                    <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
                        <span style="color: #666666; font-style: italic;">// Datei merken und ggf später öffnen</span>
                        fileToLoad <span style="color: #339933;">=</span> ae.<span style="color: #006633;">getFilename</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
                    <span style="color: #009900;">&#125;</span>
                <span style="color: #009900;">&#125;</span>
            <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span> <span style="color: #000000; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span><span style="color: #003399;">Throwable</span> e<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
            logger.<span style="color: #006633;">warn</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;setupMacOSXApplicationListener failed: &quot;</span> <span style="color: #339933;">+</span> e.<span style="color: #006633;">getMessage</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>, e<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#125;</span></pre></td></tr></table></div>

<p>Soweit nun fast alles was man braucht um den eigenen Code zu erweitern</p>
<p>Wir brauchen nun ein schickes Icon für unsere Anwendung.<br />
Dazu malt man sich in der Grösse 128&#215;128 Bit mit 256 Bit Farbtiefe ein hübsche Bildchen im PNG oder JPG-Format.<br />
Dieses Bild muss nun ind das sogenannte Icon-Format überführt werden. bei Mac OS X heissen diese Dateien .icns.<br />
Der angedeutete Plural ist nicht ohne Grund. In der Datei stecken mehrere Bilder mit gleichem Inhalt aber unterschiedlicher Auflösung und Bildgrösse um die Skalierung zu ermöglichen wenn im Doc das Bild grösser wird oder wenn im Finder grössere Icons eingestellt werden. Damit Mac OS X da was zum interpolieren hat sind mehrere unterschiedliche Grössen in einer Datei enthalten.<br />
Ein nettes (billiges aber kostenpflichtiges) Photoshop-Plugin <a href="http://www.kineticcreations.com/exporticon/">Icon Export</a> hilft hier weiter. Mit Photoshop kann man simpel ein nettes Bild bastel und es dann sogleich mit diesem Plugin in das icns-Format exportieren. Das Plugin funktioniert auch bei dem sehr preiswerten Photoshop Elements (momentan version 4.0) was jeder zweiten Digitalkamera kostenlos beiliegt oder im Laden 90 Euro kostet. Ich hatte es mir gekauft und es nie bereut !</p>
<p>Nun sind alle Zutaten zusammen: Wir haben eine nette Anwendung und auch ein hübsches Icon.</p>
<p>Nun müssen wir noch eine echte Mac-App bauen.<br />
Ich bevorzuge dazu <a href="http://ant.apache.org">ant</a>. Aktuell ist gerade die Version 1.7.0 &#8211; kann ich nur dringend empfehlen !</p>
<p>Hier ein Teil meines ant-scripts.<br />
Ich kenne nur einen wirklich sinnvollen Weg: der <a href="http://informagen.com/JarBundler/">jarbundler</a>. Das Teil ist sehr gut dokumentiert !</p>
<p>Hier ein Beispiel für ein ant-task:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family:monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;target</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;macapp&quot;</span></span>
<span style="color: #009900;">        <span style="color: #000066;">depends</span>=<span style="color: #ff0000;">&quot;jar&quot;</span></span>
<span style="color: #009900;">        <span style="color: #000066;">description</span>=<span style="color: #ff0000;">&quot;build Mac OS X application bundle&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;delete</span> <span style="color: #000066;">failonerror</span>=<span style="color: #ff0000;">&quot;false&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">includeemptydirs</span>=<span style="color: #ff0000;">&quot;true&quot;</span></span>
<span style="color: #009900;">            <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${macappdir}&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;mkdir</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${macappdir}&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;taskdef</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;jarbundler&quot;</span></span>
<span style="color: #009900;">             <span style="color: #000066;">classname</span>=<span style="color: #ff0000;">&quot;net.sourceforge.jarbundler.JarBundler&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;jarbundler</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${macappdir}&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;SQLRunner&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">shortname</span>=<span style="color: #ff0000;">&quot;SQLRunner&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">infostring</span>=<span style="color: #ff0000;">&quot;Version ${version} Copyright Jan Lolling&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">icon</span>=<span style="color: #ff0000;">&quot;${src}/sqlrunner.icns&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">version</span>=<span style="color: #ff0000;">&quot;${version}&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">mainclass</span>=<span style="color: #ff0000;">&quot;sqlrunner.Main&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">jvmversion</span>=<span style="color: #ff0000;">&quot;1.5+&quot;</span></span>
<span style="color: #009900;">                <span style="color: #000066;">vmoptions</span>=<span style="color: #ff0000;">&quot;-Xmx512m -Dcom.sun.management.jmxremote=true -Dapple.awt.graphics.UseQuartz=true&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;jarfileset</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${lib}&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;*.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/jarfileset<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;jarfileset</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${distrib}&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;include</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;sqlrunner2.jar&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/jarfileset<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;documenttype</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;SQL script&quot;</span> <span style="color: #000066;">extensions</span>=<span style="color: #ff0000;">&quot;sql&quot;</span> <span style="color: #000066;">role</span>=<span style="color: #ff0000;">&quot;Editor&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;documenttype</span> <span style="color: #000066;">name</span>=<span style="color: #ff0000;">&quot;SQLRunner CSV Import Configuration&quot;</span> <span style="color: #000066;">extensions</span>=<span style="color: #ff0000;">&quot;importconfig&quot;</span> <span style="color: #000066;">role</span>=<span style="color: #ff0000;">&quot;Editor&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/jarbundler<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;mkdir</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${macappdir}/SQLRunner.app/Contents/Resources/German.lproj&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;mkdir</span> <span style="color: #000066;">dir</span>=<span style="color: #ff0000;">&quot;${macappdir}/SQLRunner.app/Contents/Resources/English.lproj&quot;</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;delete</span> <span style="color: #000066;">file</span>=<span style="color: #ff0000;">&quot;${macappdir}/SQLRunner.app/Contents/MacOS/JavaApplicationStub&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;echo<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>copy JavaApplicationStub<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/echo<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;exec</span> <span style="color: #000066;">executable</span>=<span style="color: #ff0000;">&quot;cp&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;arg</span> <span style="color: #000066;">line</span>=<span style="color: #ff0000;">&quot;/System/Library/Frameworks/JavaVM.framework/Resources/MacOS/JavaApplicationStub&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;arg</span> <span style="color: #000066;">value</span>=<span style="color: #ff0000;">&quot;${macappdir}/SQLRunner.app/Contents/MacOS/JavaApplicationStub&quot;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/exec<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/target<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div>

<p>Java-Anwendungen werden wenn sie wie normale Mac Anwendungen gestartet werden sollen mit einem JavaStub gestartet. Dieser kann direkt in das eigene Projekt kopiert werden oder er wird verlinkt (wie im Beispiel). das direkte Kopieren hat den Nachteil das man damit die JRE-version festlegt ist aber krisenfest wenn Apple mal die Verzeichnis-Struktur von Java ändern sollte. Der symbolische Link hat den Vorteil, dass man immer mit der aktuellsten Version arbeitet und den Nachteil dass Verzeichnisänderungen der JRE ein echtes Problem darstellen würden. Seite der ersten Version von Mac OS X ist dieser Pfad aber stabil geblieben, weshalb ich das skizzierte Risiko als gering einschätze.</p>
<p>Viel Freude mit Java auf dem Mac wünscht Jan<!--:--></p>
]]></content:encoded>
			<wfw:commentRss>http://www.jug-bb.de/2007/08/java-anwendung-erstellen-fur-mac-os-x/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
	</channel>
</rss>
